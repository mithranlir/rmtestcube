<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<distributedActivePivotDescription
	xmlns="http://www.quartetfs.com" xmlns:xs="http://www.w3.org/2001/XMLSchema"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.quartetfs.com ../activepivot-types.xsd">
	
	
	<measures>
		<!-- Put native measures into a dedicated folder -->
		<nativeMeasure name="contributors.COUNT" folder="Native_measures" alias="Distributed_Count" formatter="INT[#,###]" />
		<nativeMeasure name="update.TIMESTAMP" folder="Native_measures" alias="Distributed_Timestamp" formatter="DATE[HH:mm:ss]" />
	</measures>

	<!-- Define the context of the distributed active pivot -->
	<sharedContexts>

		<!-- Drillthrough customization -->
		<drillthroughProperties>
			<!-- Setting some columns first in order based on their names -->
			<headersComparator pluginKey="Custom">
				<order name="firstObjects">
					<value>Desk</value>
					<value>UnderlierCurrency</value>
				</order>
			</headersComparator>
			<!-- Hide the standard book id, which is an object. -->
			<hiddenColumns>
				<column>BookId</column>
			</hiddenColumns>
			<calculatedColumns>
				<calculatedColumn pluginKey="DoubleAdder" name="delta + gamma" underlyingFields="delta, gamma" />
				<calculatedColumn pluginKey="BookIdColumn" name="Book ID" underlyingFields="BookId" />
			</calculatedColumns>
			<!-- Hard limit for the number of rows returned by drillthrough queries -->
			<maxRows>10000</maxRows>
		</drillthroughProperties>


		<!-- Contextual configuration of the MDX engine -->
		<mdxContext>
			<formatters>
				<!-- Measure formatting configuration -->
				<formatter uniqueName="[Measures].[update.TIMESTAMP]" 	format="DATE[HH:mm:ss]" />
				<formatter uniqueName="[Measures].[delta.SUM]" format="DOUBLE[#,###.0000;-#,###.00]" />
				<formatter uniqueName="[Measures].[pnl.SUM]" format="DOUBLE[#,###.00;-#,###.00]" />
				<formatter uniqueName="[Measures].[pnl.bucket.SUM]" format="DOUBLE[#,###.0000;-#,###.0000]" />
				<formatter uniqueName="[Measures].[pnlDelta.SUM]" format="DOUBLE[#,###.00;-#,###.00]" />
				<formatter uniqueName="[Measures].[pnlDelta.bucket.SUM]" format="DOUBLE[#,###.00;-#,###.00]" />
				<formatter uniqueName="[Measures].[pnlVega.SUM]" format="DOUBLE[#,###.00;-#,###.00]" />
				<formatter uniqueName="[Measures].[pnlVega.bucket.SUM]" format="DOUBLE[#,###.00;-#,###.00]" />	
				<formatter uniqueName="[Measures].[theta.SUM]" format="DOUBLE[#,###.0000;-#,###.00]" />
				<formatter uniqueName="[Measures].[rho.SUM]" format="DOUBLE[#,###.0000;-#,###.00]" />
				<formatter uniqueName="[Measures].[gamma.SUM]" format="DOUBLE[#,###.0000;-#,###.00]" />
				<formatter uniqueName="[Measures].[vega.SUM]" format="DOUBLE[#,###.0000;-#,###.00]" />
				<formatter uniqueName="[Measures].[pv.SUM]" format="DOUBLE[#,###.00;-#,###.00]" />
				<formatter uniqueName="[Measures].[pv.bucket.SUM]" format="DOUBLE[#,###.00;-#,###.00]" />
				<formatter uniqueName="[Measures].[pv.UnderlyingsRatio]" format="DOUBLE[#,###.00;-#,###.00]" />
				<formatter uniqueName="[Measures].[pnl.ALLMEMBER_HIDE]" format="DOUBLE[#,###.0000;-#,###.0000]" />
				<formatter uniqueName="[Measures].[pnl.Distributed_Forex]" format="DOUBLE[#,###.0000;-#,###.0000]" />

				<!-- Level member formatting configuration -->
				<formatter uniqueName="[Time].[TimeBucket].[Value Date]" format="DATE[dd-MM-yyyy]" />
				<formatter uniqueName="[Time].[HistoricalDates].[AsOfDate]" format="DATE[dd-MM-yyyy]" />

			</formatters>

			<!-- Restrict formula evaluation on the crossjoined tuples existing in 
				the cube, instead of all possible tuples. -->
			<aggressiveFormulaEvaluation>true</aggressiveFormulaEvaluation>
		</mdxContext>
		
		<!-- Do not grant pnl.FOREX, but pnl.Distributed_Forex instead -->
		<subCubeProperties isAccessGranted="true">
			<grantedMeasures>
				<measure>update.TIMESTAMP</measure>
				<measure>contributors.COUNT</measure>
				<measure>delta.SUM</measure>
				<measure>pnl.SUM</measure>
				<measure>pnl.bucket.SUM</measure>
				<measure>pnlDelta.SUM</measure>
				<measure>pnlDelta.bucket.SUM</measure>
				<measure>pnlVega.SUM</measure>
				<measure>pnlVega.bucket.SUM</measure>
				<measure>theta.SUM</measure>
				<measure>vega.SUM</measure>
				<measure>gamma.SUM</measure>
				<measure>rho.SUM</measure>
				<measure>pv.SUM</measure>
				<measure>pv.bucket.SUM</measure>
				<measure>pv.UnderlyingsRatio</measure>
				<measure>pnl.ALLMEMBER_HIDE</measure>
				<measure>pnl.Distributed_Forex</measure>
			</grantedMeasures>
		</subCubeProperties>

		<!-- Query maximum execution time (before timeout cancellation) -->
		<queriesTimeLimit seconds="30" />
	</sharedContexts>

</distributedActivePivotDescription>
